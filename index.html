<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>terrace</title>
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/terrace.css">
</head>
<body ng-app="myApp" ng-controller="terrace">
<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
=======
<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
>>>>>>> 528
<div class="header">
    <div class="left fl"><b>通用权限系统</b></div>
    <div class="right fl">个人中心&nbsp;&nbsp;&nbsp;&nbsp; 系统设置</div>
</div>
<div class="content">
    <div class="left fl">
        <div class="title"><b>></b>我的工作台</div>
        <div class="jurisdic"><h6 ng-click="shows()"><span>+</span>权限管理</h6>
            <ol ng-show=Torf>
                <li ng-repeat="i in secdata" ui-sref="{{i.page}}">{{i.name}}</li>
            </ol>
        </div>
    </div>
    <div class="right fl" ui-view></div>
</div>
<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
=======
=======
<headers></headers>
<div ui-view class="content"></div>
>>>>>>> 5.28
>>>>>>> 528

<script src="js/common/angular.js"></script>
<script src="js/common/angular-ui-router.js"></script>
<script src="js/common/jquery.js"></script>
<script>
    var app = angular.module('myApp', ['ui.router']);
    app.config(function ($stateProvider, $urlRouterProvider) {
<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
=======
<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
>>>>>>> 528
        $urlRouterProvider.otherwise('/user');
        $stateProvider
                .state({
                    name: 'role',
                    url: '/role',
<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
=======
=======
        $urlRouterProvider.otherwise('/system/system.user');
        $stateProvider
                .state({
                    name: 'system.role',
                    url: '/system.role',
>>>>>>> 5.28
>>>>>>> 528
                    templateUrl: 'role.html',
                    controller: function ($scope, alldata) {
                        $scope.fivedata = alldata.fivedata;
                        $scope.thirdata = alldata.thirdata;
                        $scope.show = true;
                        $scope.ind = $scope.thirdata.length - 1;
                        $scope.num = $scope.thirdata[$scope.ind].ID;
                        // 点击确定的事件，让该页面跳转到user页
                        $scope.win = function () {
                            $scope.num++;
                            $scope.thirdata.push($scope.tar);
                            $scope.tar.ID = $scope.num;
<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
=======
<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
=======
                            $scope.pageShow($scope.num);
>>>>>>> 5.28
>>>>>>> 528
                        };
                    }
                })
                .state({
<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
=======
<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
>>>>>>> 528
                    name: 'user',
                    url: '/user',
                    templateUrl: 'user.html',
                    controller: function ($scope, alldata) {
                        $scope.thirdata = alldata.thirdata;
                        $scope.fivedata = alldata.fivedata;
                        $scope.manage = alldata.manage;
                        $scope.status = alldata.status;
                        $scope.page = [];
                        // 分页页数的数组
                        for (var i = 1; i <= $scope.thirdata.length; i++) {
                            $scope.page.push(i);
                        }
                        // 分页
                        $scope.fit = '';
                        $scope.pages = function (i) {
                            $scope.fit = $scope.thirdata[i];
                            $scope.pink = i + 1;
                            $scope.prevs = function () {
                                i -= 1;
                                if (i < 0) {
                                    i = 0;
                                    alert('已经是第一页了！');
                                }
                                $scope.fit = $scope.thirdata[i];
                                $scope.pink = i + 1;
                            };
                            $scope.next = function () {
                                i += 1;
                                if (i > $scope.thirdata.length - 1) {
                                    i = $scope.thirdata.length - 1;
                                    alert('已经是最后一页了！');
                                }
                                $scope.fit = $scope.thirdata[i];
                                $scope.pink = i + 1;
                            };
                        };
                        // 第几页的值
                        $scope.blur = function () {
                            var i = $scope.sum;
                            $scope.fit = $scope.thirdata[$scope.sum - 1];
                            $scope.pink = i;
                            $scope.prevs = function () {
                                i -= 1;
                                if (i < 0) {
                                    i = 0;
                                    alert('已经是第一页了！');
                                }
                                $scope.fit = $scope.thirdata[i];
                                $scope.pink = i + 1;
                            };
                            $scope.next = function () {
                                i += 1;
                                if (i > $scope.thirdata.length - 1) {
                                    i = $scope.thirdata.length - 1;
                                    alert('已经是最后一页了！');
                                }
                                $scope.fit = $scope.thirdata[i];
                                $scope.pink = i + 1;
                            };
                        };
                        $scope.show = false;
                        // 修改
                        $scope.change = function (i) {
                            $scope.show = true;
                            $scope.gai = $scope.thirdata[i];
                            $scope.tar = {};
                            $scope.thirdata.forEach(function (val) {
<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
=======
=======
                    name: 'system.user',
                    url: '/system.user',
                    templateUrl: 'user.html',
                    controller: function ($scope, alldata, $filter, paging) {
                        $scope.fivedata = alldata.fivedata;
                        $scope.manage = alldata.manage;
                        $scope.data = alldata.thirdata;
                        $scope.status = alldata.status;
                        // 筛选
                        $scope.fileData = function () {
                            return $filter('filter')($scope.data, {
                                loginname: $scope.roleName,
                                state: $scope.statues,
                                role: $scope.manages
                            })
                        };
                        // 每一页显示的数据长度
                        $scope.maxLength = 2;
                        paging($scope);
                        // 显示的起始页为1
                        $scope.pageShow(1);
                        // 查询
                        $scope.searchFn = function () {
                            console.log($scope.roleName);
                            console.log($scope.statues);
                            console.log($scope.manages);
                            $scope.pageShow(1)
                        };
                        // 删除
                        $scope.delete = function (item) {
                            //通过过滤后的数据找当前显示页
                            var indexPage;
                            $scope.fileData().forEach(function (i, index) {
                                if (i.ID == item.ID) {
                                    indexPage = Math.ceil(index / $scope.maxLength);
                                }
                            });
                            $scope.pageShow(indexPage);
                            //    在原始数据上进行数据的剪切
                            var a = confirm('确定要删除吗？');
                            $scope.data.forEach(function (i, index) {
                                if (i.ID == item.ID && a) {
                                    $scope.data.splice(index, 1)

                                }
                            });
                        };
                        // 修改
                        $scope.change = function (i) {
                            $scope.show = true;
                            $scope.gai = $scope.data[i];
                            $scope.tar = {};
                            $scope.data.forEach(function (val) {
>>>>>>> 5.28
>>>>>>> 528
                                for (j in val) {
                                    if (i == val.ID) {
                                        $scope.tar[j] = val[j];
                                    }
                                }
                            });
<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
=======
<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
>>>>>>> 528
                        };
                        // 点击修改的事件
                        $scope.sures = function () {
                            $scope.thirdata.forEach(function (val, i) {
                                if (val.ID == $scope.tar.ID) {
                                    $scope.thirdata[i] = $scope.tar;
<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
=======
=======
                            $scope.pageShow(i);
                        };
                        // 点击修改的事件
                        $scope.sures = function () {
                            $scope.data.forEach(function (val, i) {
                                for (j in val) {
                                    if (val.ID == $scope.tar.ID) {
                                        val[j] = $scope.tar[j];
                                    }
>>>>>>> 5.28
>>>>>>> 528
                                }
                            });
                            $scope.show = false;
                        };
                        // 隐藏修改框
                        $scope.hide = function () {
                            $scope.show = false;
                        };
<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
=======
<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
>>>>>>> 528
                        // 删除
                        $scope.delete = function (index) {
                            $scope.thirdata.forEach(function (val, i) {
                                if (index == val.ID) {
                                    $scope.thirdata.splice(i, 1);
                                    $scope.page.length = $scope.page.length - 1;
                                }
                            })
                        };
                        // 筛选
                        $scope.fil = function () {
                            $scope.man = $scope.manages;
                            $scope.stat = $scope.statues;
                            $scope.logos = $scope.logo;
                        };
                        $(document).on('click', function () {
                            var sel = $('.pink').html();
                            $('.choose input').val(sel);
                        });
                    }
                });
    });
    app.controller('terrace', function ($scope, alldata) {
        $scope.Torf = true;
        $scope.secdata = alldata.secdata;

<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
=======
=======
                    }
                });
    });

    app.service('paging', function () {
        return function ($scope) {
            $scope.pageShow = function (i) {
                var oldData = $scope.fileData();
                $scope.allPage = Math.ceil(oldData.length / $scope.maxLength);
                $scope.pageArr = [];
                for (var k = 2; k < $scope.allPage; k++) {
                    $scope.pageArr.push(k)
                }

                $scope.index = i - 1;
                $scope.showStatue1 = false;
                $scope.showStatue2 = false;
                if ($scope.index <= 3) {
                    $scope.showStatue1 = false;
                    $scope.showStatue2 = true;
                    $scope.self = 1;
                    $scope.self_1 = 2;
                    $scope.self_2 = 3;
                    $scope.self1 = 4;
                    $scope.self2 = 5;
                } else if ($scope.index > 3 && $scope.index < $scope.allPage - 4) {
                    $scope.showStatue1 = true;
                    $scope.showStatue2 = true;
                    $scope.self = $scope.index + 1;
                    $scope.self_1 = $scope.index;
                    $scope.self_2 = $scope.index - 1;
                    $scope.self1 = $scope.index + 2;
                    $scope.self2 = $scope.index + 3;
                } else {
                    $scope.showStatue1 = true;
                    $scope.showStatue2 = false;
                    $scope.self = $scope.allPage - 1;
                    $scope.self_1 = $scope.allPage - 2;
                    $scope.self_2 = $scope.allPage - 3;
                    $scope.self1 = $scope.allPage - 4;
                }
                if ($scope.allPage <= 6) {
                    $scope.showStatue1 = false;
                    $scope.showStatue2 = false;
                }
                $scope.cutDataFn()
                $scope.valueDATA = i;

            };

            $scope.cutDataFn = function () {
                var newdata = $scope.fileData()
                $scope.cutoutData = newdata.splice($scope.index * $scope.maxLength, $scope.maxLength);
                console.log($scope.cutoutData)
            };
            $scope.changeIndexFn = function (i) {
                $scope.pageShow(i)
            };
            $scope.updownFn = function (i) {
                if (i == "+") {
                    if ($scope.index + 1 < $scope.allPage) {
                        $scope.pageShow($scope.index + 2)
                    }
                } else {
                    if ($scope.index > 0) {
                        $scope.pageShow($scope.index)
                    }
                }
            };
            $scope.changeInput = function (j) {
                $scope.pageShow(j);
            };
        }
    });

    app.controller('terrace', function ($scope, alldata, paging, $filter) {
        $scope.Torf = true;
        $scope.secdata = alldata.secdata;

        paging($scope);

>>>>>>> 5.28
>>>>>>> 528
        // 点击权限管理   判断信息列表的显示隐藏
        $scope.shows = function () {
            $scope.Torf == true ? $scope.Torf = false : $scope.Torf = true;
        };
<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
=======
<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
>>>>>>> 528
    });
    app.factory('alldata', function () {
        return {
            fstdata: [
                {
                    id: 1,
                    name: '个人中心',
                    nickname: '账户管理'
                },
                {
                    id: 2,
                    name: '系统设置',
                    nickname: '权限管理'
                }
            ],
            secdata: [
                {
                    id: 22,
                    parentid: 2,
                    name: '角色管理',
                    page: 'role'
                },
                {
                    id: 23,
                    parentid: 2,
                    name: '用户管理',
                    page: 'user'
                }
            ],
            thirdata: [
                {
                    ID: 1,
                    parentid: 23,
                    loginname: 'zhangsan',
                    name: '张三',
                    role: '13管理员aaa',
                    telephone: '15098950322',
                    email: '837990335@qq.com',
                    state: '启用',
                    creattime: '2014-07-27 16:56'
                },
                {
                    ID: 2,
                    parentid: 23,
                    loginname: 'lisi',
                    name: '李四',
                    role: '13管理员aaa',
                    telephone: '15098950322',
                    email: '837990335@qq.com',
                    state: '禁用',
                    creattime: '2014-07-27 16:56'
                },
                {
                    ID: 3,
                    parentid: 23,
                    loginname: 'wangwu',
                    name: '王五',
                    role: '13管理员aaa',
                    telephone: '15098950322',
                    email: '837990335@qq.com',
                    state: '启用',
                    creattime: '2014-07-27 16:56'
                },
                {
                    ID: 4,
                    parentid: 23,
                    loginname: 'zhangchen',
                    name: '张晨',
                    role: '13管理员aaa',
                    telephone: '15098950322',
                    email: '837990335@qq.com',
                    state: '启用',
                    creattime: '2014-07-27 16:56'
                },
                {
                    ID: 5,
                    parentid: 23,
                    loginname: 'liucheng',
                    name: '刘成',
                    role: '管理员',
                    telephone: '15098950322',
                    email: '837990335@qq.com',
                    state: '禁用',
                    creattime: '2014-07-27 16:56'
                },
                {
                    ID: 6,
                    parentid: 23,
                    loginname: 'liji',
                    name: '李继',
                    role: '13管理员aaa',
                    telephone: '15098950322',
                    email: '837990335@qq.com',
                    state: '禁用',
                    creattime: '2014-07-27 16:56'
                },
                {
                    ID: 7,
                    parentid: 23,
                    loginname: 'yuantao',
                    name: '袁涛',
                    role: '13管理',
                    telephone: '15098950322',
                    email: '837990335@qq.com',
                    state: '启用',
                    creattime: '2014-07-27 16:56'
                },
                {
                    ID: 8,
                    parentid: 23,
                    loginname: 'wangjian',
                    name: '王建',
                    role: '管理员',
                    telephone: '15098950322',
                    email: '837990335@qq.com',
                    state: '禁用',
                    creattime: '2014-07-27 16:56'
                }
            ],
            fourdata: [
                {
                    ID: 1,
                    role: "管理员",
                    state: "启用",
                    orders: 0,
                    creattime: '2014-07-27 16:35'
                },
                {
                    ID: 2,
                    role: "管理员2",
                    state: "禁用",
                    orders: 2,
                    creattime: '2014-07-27 16:35'
                },
                {
                    ID: 3,
                    role: "管理员",
                    state: "禁用",
                    orders: 5,
                    creattime: '2014-07-27 16:35'
                },
                {
                    ID: 4,
                    role: "管理员2",
                    state: "启用",
                    orders: 0,
                    creattime: '2014-07-27 16:35'
                },
                {
                    ID: 5,
                    role: "管理员0",
                    state: "启用",
                    orders: 2,
                    creattime: '2014-07-27 16:35'
                },
                {
                    ID: 6,
                    role: "管理员1",
                    state: "禁用",
                    orders: 0,
                    creattime: '2014-07-27 16:35'
                },
                {
                    ID: 7,
                    role: "管理员是",
                    state: "启用",
                    orders: 0,
                    creattime: '2014-07-27 16:35'
                },
                {
                    ID: 8,
                    role: "管理员0",
                    state: "启用",
                    orders: 1,
                    creattime: '2014-07-27 16:35'
                },
                {
                    ID: 9,
                    role: "管理员2",
                    state: "启用",
                    orders: 0,
                    creattime: '2014-07-27 16:35'
                },
                {
                    ID: 10,
                    role: "管理2",
                    state: "启用",
                    orders: 0,
                    creattime: '2014-07-27 16:35'
                },
                {
                    ID: 11,
                    role: "管理员2",
                    state: "禁用",
                    orders: 0,
                    creattime: '2014-07-27 16:35'
                }

            ],
            fivedata: [
                {
                    name: 'ID'
                },
                {
                    name: '登录名'
                },
                {
                    name: '真实姓名'
                },
                {
                    name: '角色'
                },
                {
                    name: '手机'
                },
                {
                    name: '邮箱'
                },
                {
                    name: '状态'
                },
                {
                    name: '创建时间'
                },
                {
                    name: '操作'
                }
            ],
            manage: ['管理员', '13管理', '13管理员aaa'],
            status: ['禁用', '启用']
        }
    });

<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
=======
=======


    });


>>>>>>> 5.28
>>>>>>> 528
    // 选中列表的样式改变
    $('.left').on('click', 'li', function () {
        $(this).addClass('pitch').siblings().removeClass('pitch');
    });


</script>
<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
=======
<<<<<<< e1ebd22d9f2cee081726a00b4384250cf0698b28
=======
<script src="js/data.js"></script>
<script src="js/service.js"></script>
<script src="js/index.js"></script>

>>>>>>> 5.28
>>>>>>> 528
</body>
</html>